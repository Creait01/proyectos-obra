<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- ======================================== -->
    <!-- WIZARD CIERRE MASIVO MULTI-EMPRESA       -->
    <!-- ======================================== -->

    <record id="view_cash_register_mass_close_wizard_form" model="ir.ui.view">
        <field name="name">cash.register.mass.close.wizard.form</field>
        <field name="model">cash.register.mass.close.wizard</field>
        <field name="arch" type="xml">
            <form string="Cierre Masivo Multi-Empresa">
                <sheet>
                    <!-- Header Principal -->
                    <div class="oe_title" style="margin-bottom: 20px;">
                        <h1 style="display: flex; align-items: center; gap: 12px;">
                            <span style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; width: 50px; height: 50px; border-radius: 12px; display: flex; align-items: center; justify-content: center;">
                                <i class="fa fa-building"/>
                            </span>
                            <span>Cierre Masivo Multi-Empresa</span>
                        </h1>
                    </div>

                    <!-- Tarjetas de Resumen -->
                    <div style="display: flex; gap: 16px; margin-bottom: 24px; flex-wrap: wrap;">
                        <!-- Tarjeta: Empresas Seleccionadas -->
                        <div style="flex: 1; min-width: 180px; background: #ffffff; border: 2px solid #4361ee; border-radius: 16px; padding: 20px; text-align: center; box-shadow: 0 2px 8px rgba(67, 97, 238, 0.15);">
                            <div style="background: linear-gradient(135deg, #4361ee 0%, #3a0ca3 100%); width: 50px; height: 50px; border-radius: 12px; margin: 0 auto 12px; display: flex; align-items: center; justify-content: center;">
                                <i class="fa fa-building fa-lg" style="color: white;"/>
                            </div>
                            <div style="font-size: 42px; font-weight: 800; color: #4361ee; line-height: 1;">
                                <field name="companies_count" nolabel="1"/>
                            </div>
                            <div style="font-size: 14px; color: #64748b; margin-top: 8px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px;">
                                Seleccionadas
                            </div>
                        </div>

                        <!-- Tarjeta: Ya Tienen Cierre -->
                        <div style="flex: 1; min-width: 180px; background: #ffffff; border: 2px solid #f59e0b; border-radius: 16px; padding: 20px; text-align: center; box-shadow: 0 2px 8px rgba(245, 158, 11, 0.15);">
                            <div style="background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); width: 50px; height: 50px; border-radius: 12px; margin: 0 auto 12px; display: flex; align-items: center; justify-content: center;">
                                <i class="fa fa-check-circle fa-lg" style="color: white;"/>
                            </div>
                            <div style="font-size: 42px; font-weight: 800; color: #f59e0b; line-height: 1;">
                                <field name="existing_closes_count" nolabel="1"/>
                            </div>
                            <div style="font-size: 14px; color: #64748b; margin-top: 8px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px;">
                                Ya Tienen
                            </div>
                        </div>

                        <!-- Tarjeta: Se Crear√°n -->
                        <div style="flex: 1; min-width: 180px; background: #ffffff; border: 2px solid #10b981; border-radius: 16px; padding: 20px; text-align: center; box-shadow: 0 2px 8px rgba(16, 185, 129, 0.15);">
                            <div style="background: linear-gradient(135deg, #10b981 0%, #059669 100%); width: 50px; height: 50px; border-radius: 12px; margin: 0 auto 12px; display: flex; align-items: center; justify-content: center;">
                                <i class="fa fa-plus-circle fa-lg" style="color: white;"/>
                            </div>
                            <div style="font-size: 42px; font-weight: 800; color: #10b981; line-height: 1;">
                                <field name="new_closes_count" nolabel="1"/>
                            </div>
                            <div style="font-size: 14px; color: #64748b; margin-top: 8px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px;">
                                Se Crear√°n
                            </div>
                        </div>
                    </div>

                    <!-- Configuraci√≥n y Empresas -->
                    <group>
                        <group string="‚öôÔ∏è Configuraci√≥n">
                            <field name="date" widget="date"/>
                            <field name="auto_generate_lines"/>
                            <field name="skip_existing"/>
                        </group>
                        <group string="üè¢ Empresas">
                            <field name="select_all_companies"/>
                            <field name="company_ids" widget="many2many_tags" 
                                   placeholder="Seleccione empresas..." 
                                   options="{'no_create': True}"
                                   attrs="{'invisible': [('select_all_companies', '=', True)]}"/>
                        </group>
                    </group>
                    
                    <!-- Vista Previa -->
                    <group string="üìã Detalle de Empresas" attrs="{'invisible': [('companies_count', '=', 0)]}">
                        <field name="companies_summary" nolabel="1" colspan="2"/>
                    </group>
                </sheet>
                
                <footer>
                    <button name="action_create_mass_close" type="object" 
                            string="üöÄ Crear Cierres" class="btn-primary btn-lg"
                            attrs="{'invisible': [('new_closes_count', '=', 0)]}"
                            confirm="¬øEst√° seguro de crear cierres de caja para las empresas seleccionadas?"/>
                    <button name="action_view_preview" type="object" 
                            string="üëÅÔ∏è Vista Previa" class="btn-secondary"/>
                    <button string="Cancelar" class="btn-secondary" special="cancel"/>
                </footer>
            </form>
        </field>
    </record>

    <!-- Acci√≥n del Wizard -->
    <record id="action_cash_register_mass_close_wizard" model="ir.actions.act_window">
        <field name="name">Cierre Masivo Multi-Empresa</field>
        <field name="res_model">cash.register.mass.close.wizard</field>
        <field name="view_mode">form</field>
        <field name="target">new</field>
        <field name="context">{'default_select_all_companies': True}</field>
    </record>

</odoo>
